---

layout: post

title: "[Java-Effective] Stream / Optional "

comments: true

categories: [Java, Stream]

tags: [Java, Stream, Lambda]

---

### Stream

ìŠ¤íŠ¸ë¦¼ (Stream)

- ë°°ì—´, ì»¬ë ‰ì…˜ì˜ ì €ì¥ìš”ì†Œë¥¼ í•˜ë‚˜ì”© ì°¸ì¡°í•˜ì—¬ ëŒë‹¤ì‹ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ë°˜ë³µì
- List, Set, Map, ë°°ì—´ ë“± ë‹¤ì–‘í•œ ë°ì´í„° ì†ŒìŠ¤ë¡œë¶€í„° ë§Œë“¤ ìˆ˜ ìˆë‹¤
- ë°ì´í„° ì†ŒìŠ¤ë¥¼ ë‹¤ë£¨ëŠ” í’ë¶€í•œ ë©”ì„œë“œ ì œê³µìŠ¤íŠ¸ë¦¼ì˜ íŠ¹ì§•
- ì¤‘ê°„ì—°ì‚°ê³¼ ìµœì¢…ì—°ì‚°ì„ í•  ìˆ˜ ìˆë‹¤
- ì„ ì–¸í˜•ìœ¼ë¡œ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ì²˜ë¦¬
  - ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë° : "ì–´ë–»ê²Œ" ë³´ë‹¨ "ë¬´ì—‡ì„" ìˆ˜í–‰í•˜ëŠ”ì§€ì— ê´€ì‹¬ì„ ë‘ëŠ” í”„ë¡œê·¸ë˜ë° íŒ¨ëŸ¬ë‹¤ì„
  - "ì–´ë–»ê²Œ"ì˜ ì˜ì—­ì€ ì¶”ìƒí™” ë˜ì–´ìˆë‹¤
  - ë‚´ë¶€ì˜ ì›ë¦¬ë¥¼ ëª¨ë¥´ë”ë¼ë„ ì½”ë“œê°€ ë¬´ìŠ¨ ì¼ì„ í•˜ëŠ” ì§€ ì´í•´í•  ìˆ˜ ìˆë‹¤
- ëŒë‹¤ì‹ ìš”ì†Œì²˜ë¦¬ ì½”ë“œ ì œê³µ
  - ëŒë‹¤ì‹ ë˜ëŠ” ë©”ì„œë“œ ì°¸ì¡°ë¥¼ ì´ìš©í•˜ì—¬ ìš”ì†Œ ì²˜ë¦¬ ë‚´ìš©ì„ ë§¤ê°œê°’ìœ¼ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤
- ë‚´ë¶€ ë°˜ë³µìë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ë³‘ë ¬ ì²˜ë¦¬ê°€ ì‰½ë‹¤
  - ì™¸ë¶€ë°˜ë³µì(external iterator) : ê°œë°œìê°€ ì½”ë“œë¡œ ì§ì ‘ ì»¬ë ‰ì…˜ì˜ ìš”ì†Œë¥¼ ë°˜ë³µí•´ì„œ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œ íŒ¨í„´. forë¬¸, Iteratorë¥¼ ì´ìš©í•˜ëŠ” whileë¬¸ ë“±
  - ë‚´ë¶€ë°˜ë³µì(internal iterator) : ì»¬ë ‰ì…˜ ë‚´ë¶€ì—ì„œ ìš”ì†Œë“¤ì„ ë°˜ë³µì‹œí‚¤ê³  ê°œë°œìëŠ” ìš”ì†Œ ë‹¹ ì²˜ë¦¬í•´ì•¼í•  ì½”ë“œë§Œ ì œê³µí•˜ëŠ” ì½”ë“œ íŒ¨í„´ (ë³‘ë ¬ ìŠ¤íŠ¸ë¦¼)

![img](https://velog.velcdn.com/images/hyoreal51/post/2a867998-efbd-43dc-8529-7031ca5c4cbc/image.png)

```java
double ageAve = list.stream() // ì˜¤ë¦¬ì§€ë„ ìŠ¤íŠ¸ë¦¼
  .filter(m -> m.getGender() == Member.MALE) // ì¤‘ê°„ì—°ì‚° ìŠ¤íŠ¸ë¦¼
  .mapToInt(Member::getAge) // ì¤‘ê°„ì—°ì‚° ìŠ¤íŠ¸ë¦¼
  .average() // ìµœì¢…ì—°ì‚°
  .getAsDouble();
```

- ë¦¬ë•ì…˜(Reduction) : ë‹¤ëŸ‰ì˜ ë°ì´í„°ë¥¼ ê°€ê³µí•´ì„œ ì¶•ì†Œí•˜ëŠ” ê²ƒ
- íŒŒì´í”„ë¼ì¸(pipelines) : ì—¬ëŸ¬ê°œì˜ ìŠ¤íŠ¸ë¦¼ì´ ì—°ê²°ë˜ì–´ìˆëŠ” êµ¬ì¡°
  - ìµœì¢…ì—°ì‚°ì„ ì œì™¸í•˜ê³ ëŠ” ëª¨ë‘ ì¤‘ê°„ì—°ì‚° ìŠ¤íŠ¸ë¦¼
  - ìµœì¢…ì—°ì‚° ë©”ì„œë“œê°€ í˜¸ì¶œë ë•Œ ì¤‘ê°„ì—°ì‚°ì´ ì‹¤í–‰ë˜ëŠ” êµ¬ì¡°

------

ìŠ¤íŠ¸ë¦¼ ìƒì„±

```java
  // list ìƒì„±
  List<String> list = Arrays.asList("a", "b", "c");
  // listë¡œ stream ìƒì„±
  Stream<String> listStream = list.stream();
  // streamì˜ ëª¨ë“  ìš”ì†Œ ì¶œë ¥
  listStream.forEach(System.out::println);
  
  // ë°°ì—´ë¡œë¶€í„° ìŠ¤íŠ¸ë¦¼ ìƒì„±
  Stream<String> stream = Stream.of("a", "b", "c"); // ê°€ë³€ì¸ì
  Stream<String> stream = Stream.of(new String[] {"a", "b", "c"});
  Stream<String> stream = Arrays.stream(new String[] {"a", "b", "c"});
  Stream<String> stream = Arrays.stream(new String[] {"a", "b", "c"}, 0, 3); // end ë²”ìœ„ ë¯¸í¬í•¨
  
  // íŠ¹ìˆ˜ ì¢…ë¥˜ Stream ì‚¬ìš© (IntStream, LongStream, DoubleStream ë“±ë“±)
  // 4 ì´ìƒ 10 ë¯¸ë§Œì˜ ìˆ˜ë¥¼ ê°–ëŠ” IntStream
  // IntStream ì€ range() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ forë¬¸ ëŒ€ì²´ ê°€ëŠ¥
  IntStream stream = IntStream.range(4, 10);
```

- ìŠ¤íŠ¸ë¦¼ì€ ë°ì´í„°ë¥¼ ì½ê¸°ë§Œ í•  ë¿, ë³€ê²½X
- ìŠ¤íŠ¸ë¦¼ì€ í•œë²ˆ ìµœì¢…ì—°ì‚° ì‹¤í–‰í•˜ë©´ ë.(ì¼íšŒìš©)
- í•„ìš”í•˜ë‹¤ë©´ ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¦¼ì„ ìƒì„±í•´ì•¼í•¨
  - [ğŸ”—Stream<> Methods](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html)
  - [ğŸ”—IntStream Methods](https://docs.oracle.com/javase/8/docs/api/java/util/stream/IntStream.html)

------

- Collection VS Stream 

  |                       | **Collection**                     | **Stream**                                       |
  | --------------------- | ---------------------------------- | ------------------------------------------------ |
  | ëª©ì                   | íŠ¹ì • ìë£Œêµ¬ì¡°ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì €ì¥ | ë°ì´í„° ê°€ê³µì²˜ë¦¬                                  |
  | ë°ì´í„° ìˆ˜ì • ê°€ëŠ¥ ìœ ë¬´ | ë°ì´í„° ì¶”ê°€/ì‚­ì œ ê°€ëŠ¥              | ë°ì´í„° ì¶”ê°€/ì‚­ì œ ë¶ˆê°€                            |
  | Iteration             | forë¬¸ ë“±ì˜ ì™¸ë¶€ ë°˜ë³µì ì‚¬ìš©        | operation ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ ë³´ì´ì§€ ì•Šê²Œ ë‚´ë¶€ë°˜ë³µì |
  | íƒìƒ‰                  | ì—¬ëŸ¬ë²ˆ ê°€ëŠ¥                        | í•œë²ˆë§Œ ê°€ëŠ¥                                      |
  | ë°ì´í„° ì²˜ë¦¬ë°©ì‹       | Eager                              | Lazy, Short-circuit                              |

  - Eager : ì¦‰ì‹œ ì‘ì—… ìˆ˜í–‰
  - Lazy : ë°ì´í„° ì§€ì—° (ìŠ¤íŠ¸ë¦¼ì€ ìµœì¢…ì—°ì‚° ì‹œì‘ ì „ê¹Œì§€ ì§€ì—°ë¨)
  - Short-circuit : ë‹¨ë½ í‰ê°€

- Optional< T >

  - NullPointerException(NPE), ì¦‰ null ê°’ìœ¼ë¡œ ì¸í•œ ì—ëŸ¬ ë°œìƒ í˜„ìƒì„ ê°ì²´ ì°¨ì›ì—ì„œ íš¨ìœ¨ì ìœ¼ë¡œ ë°©ì§€í•˜ê³ ì ë„ì…
  - ì—°ì‚° ê²°ê³¼ë¥¼ Optionalì— ë‹´ì•„ ë°˜í™˜í•˜ë©´, ë”°ë¡œ ì¡°ê±´ë¬¸ì„ ì‘ì„±í•´ì£¼ì§€ ì•Šì•„ë„ NPEê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì½”ë“œ ì‘ì„±ê°€ëŠ¥
  - Optional í´ë˜ìŠ¤ëŠ” ëª¨ë“  íƒ€ì…ì˜ ê°ì²´ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” ë˜í¼(Wrapper) í´ë˜ìŠ¤
  - Optional ê°ì²´ ìƒì„±ì‹œ `of()` ë˜ëŠ” `ofNullable()` ì‚¬ìš©
  - ì°¸ì¡°ë³€ìˆ˜ì˜ ê°’ì´ nullì¼ ê°€ëŠ¥ì„±ì´ ìˆë‹¤ë©´ `ofNullable()` ì‚¬ìš©
  - [ğŸ”—Optional Methods](https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html)